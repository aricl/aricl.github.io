/**
 * jquery.Batch
 * 
 *
 * @author Robert Corley
 * 
 */

;(function( $ ){
  var methods = {

    /**
     * Constructor
     * 
     */ 
    init : function( options ) {
        
        return $(this);
        
    },

    // ------------------------------------------------------------------------

    /**
     * Mark as Paid
     * 
     * Hides the unecessary buttons once a payment has been made and also
     * changes the 'Paid' column to 'Yes'.
     * 
     */
     mark_as_paid: function() {
        $(this).parent().parent().find('a.copy_to_clip_board').remove();
        $(this).parent().parent().find('a.view_invoices').remove();
        $(this).parent().parent().find('td:contains("No")').each(function(){
            if ($(this).text() == 'No') {
                $(this).html('Yes');
            }
        })
        return $(this);
    },

    // ------------------------------------------------------------------------

    /**
     * Refresh Table
     * 
     * Updates the sites -> checking table when an invoice is removed from
     * the batch.
     * 
     */
     refresh_table: function() {
        
        $('tr.content div.table').ContentBox('update');
        
        return $(this);
        
    },

    // ------------------------------------------------------------------------

    /**
     * Blur Time Check
     * 
     * Check to make sure the time that the window has been blured for is
     * a reasonable amount of time.
     * 
     */
     blur_time_check: function( options ) {
        
        $('a.copy').zclip('show'); // enable zClip on the selected element
        $('a.copy').zclip('hide'); // hide zClip on the selected element
        $('a.copy').zclip('remove'); // remove zClip from the selected element
        
        
        
        return $(this);
        
    }
  };

  // ----------------------------------------------------------------------

  /**
   * Setup method handler
   */
  $.fn.Batch = function( method ) {
        if ( methods[method] ) {
          return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || ! method ) {
          return methods.init.apply( this, arguments );
        } else {
          $.error( 'Method ' +  method + ' does not exist on jQuery.Batch' );
        }    
    };
})( jQuery );